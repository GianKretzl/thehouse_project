# Render Blueprint - The House Institute Platform
services:
  # PostgreSQL Database
  - type: pserv
    name: thehouse-db
    env: docker
    plan: free
    region: ohio
    databaseName: thehouse_institute
    databaseUser: thehouse_user
    ipAllowList: []

  # Backend API (FastAPI)
  - type: web
    name: thehouse-backend
    runtime: python
    plan: free
    region: ohio
    repo: https://github.com/SEU_USUARIO/thehouse_project # ALTERE AQUI
    rootDir: backend
    buildCommand: |
      pip install --upgrade pip
      pip install -r requirements.txt
      alembic upgrade head
      python seed_test_data.py
    startCommand: uvicorn app.main:app --host 0.0.0.0 --port $PORT
    envVars:
      - key: DATABASE_URL
        fromDatabase:
          name: thehouse-db
          property: connectionString
      - key: SECRET_KEY
        generateValue: true
      - key: PROJECT_NAME
        value: The House Platform
      - key: DEBUG
        value: False
      - key: BACKEND_CORS_ORIGINS
        value: '["https://thehouse-frontend.onrender.com"]' # ALTERE APÓS CRIAR FRONTEND
    healthCheckPath: /docs

  # Frontend (Next.js)
  - type: web
    name: thehouse-frontend
    runtime: node
    plan: free
    region: ohio
    repo: https://github.com/SEU_USUARIO/thehouse_project # ALTERE AQUI
    rootDir: frontend
    buildCommand: |
      npm install -g pnpm
      pnpm install --no-frozen-lockfile
      pnpm build
    startCommand: pnpm start
    envVars:
      - key: NEXT_PUBLIC_API_URL
        value: https://thehouse-backend.onrender.com # ALTERE APÓS CRIAR BACKEND
      - key: NODE_ENV
        value: production
